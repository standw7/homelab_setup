# MacroNotion

**URL:** `http://meals.homelab`
**Profile:** core (always running)
**Image:** `ghcr.io/standw7/macronotion-frontend:latest` (frontend), `ghcr.io/standw7/macronotion-backend:latest` (backend)

## What It Does

A meal planning application that syncs with Notion. Track meals, macros, and nutrition with a clean web interface. Built with Next.js (frontend) and FastAPI (backend) with SQLite storage.

## Required Environment Variables

| Variable | Description | How to Get |
|----------|-------------|-----------|
| `MACRONOTION_SECRET_KEY` | JWT signing secret | Auto-generated by setup script, or `openssl rand -hex 32` |
| `MACRONOTION_NOTION_CLIENT_ID` | Notion OAuth Client ID | [Notion Integrations](https://www.notion.so/my-integrations) |
| `MACRONOTION_NOTION_CLIENT_SECRET` | Notion OAuth Client Secret | Same as above |

## First-Time Setup

1. Start the stack: `docker compose up -d`
2. Create a Notion integration:
   - Go to [https://www.notion.so/my-integrations](https://www.notion.so/my-integrations)
   - Create a new integration
   - Set redirect URI to `http://meals.homelab/auth/notion/callback`
   - Copy Client ID and Client Secret
3. Add credentials to `.env`:
   ```
   MACRONOTION_NOTION_CLIENT_ID=your-client-id
   MACRONOTION_NOTION_CLIENT_SECRET=your-client-secret
   ```
4. Restart: `docker compose restart macronotion-backend macronotion-frontend`
5. Open `http://meals.homelab` and connect your Notion account

## Configuration

**Data:** Stored in Docker volume `macronotion_db` (SQLite database)

## Troubleshooting

**Notion OAuth fails:** Verify the redirect URI in your Notion integration settings matches exactly: `http://meals.homelab/auth/notion/callback`

**Backend errors:** Check logs:
```bash
docker compose logs macronotion-backend
```
