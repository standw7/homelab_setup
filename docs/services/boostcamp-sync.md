# Boostcamp Sync

**URL:** `http://boostcamp-sync.homelab`
**Profile:** `media`
**Image:** `ghcr.io/standw7/boostcamp-sync:latest`

## What It Does

Syncs Boostcamp (iOS) lifting workouts to Strava. Works via an iOS Shortcut that reads workout data from Apple Health and sends it to this API, which then creates a Strava activity.

## Required Environment Variables

| Variable | Description | How to Get |
|----------|-------------|-----------|
| `BOOSTCAMP_SYNC_API_KEY` | API key for iOS Shortcut authentication | Auto-generated by setup script, or `openssl rand -hex 32` |
| `STRAVA_CLIENT_ID` | Strava API app ID | [Strava API Settings](https://www.strava.com/settings/api) |
| `STRAVA_CLIENT_SECRET` | Strava API secret | Same as above |
| `STRAVA_REFRESH_TOKEN` | Strava OAuth refresh token | Generated after Strava OAuth flow |

## First-Time Setup

1. Set up Strava API credentials (see [Strava guide](strava.md))
2. Add credentials to `.env`
3. Start with media profile: `docker compose --profile media up -d`
4. Test the API:
   ```bash
   curl -X POST http://boostcamp-sync.homelab/api/sync \
     -H "Content-Type: application/json" \
     -H "X-API-Key: YOUR_API_KEY" \
     -d '{"duration": 3600, "calories": 450, "start_date": "2026-01-01T08:30:00-07:00"}'
   ```
5. Set up the iOS Shortcut on your iPhone (see below)

## iOS Shortcut Setup

Create an Apple Shortcut that runs after a Boostcamp workout:
1. Trigger: After Boostcamp workout completes
2. Action: Get workout data from Apple Health (duration, calories, start time)
3. Action: Send HTTP POST to `http://boostcamp-sync.homelab/api/sync` with the data
4. Header: `X-API-Key: YOUR_API_KEY`

## Configuration

**Data:** Stored in Docker volume `boostcamp_sync_data`

## Troubleshooting

**API returns 401:** Check that the `X-API-Key` header matches `BOOSTCAMP_SYNC_API_KEY` in `.env`.

**Strava activity not created:** Verify Strava credentials are correct. Check logs:
```bash
docker compose --profile media logs boostcamp-sync
```
